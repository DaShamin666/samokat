name: ⚡ Quick Check

on:
  push:
    branches: [ main, develop ]
    paths:
      - 'tests/**'
      - 'pages/**'
      - 'config/**'
      - 'conftest.py'
      - 'pytest.ini'
  workflow_dispatch:

env:
  PYTHON_VERSION: '3.12'

jobs:
  quick-smoke-check:
    name: ⚡ Quick Smoke Check
    runs-on: ubuntu-latest
    timeout-minutes: 8
    
    steps:
    - name: 📥 Checkout code
      uses: actions/checkout@v5
      
    - name: 🐍 Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: ${{ env.PYTHON_VERSION }}
        cache: 'pip'
        
    - name: 📦 Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install playwright pytest pytest-playwright faker
        
    - name: 🎭 Install Playwright Chromium only
      run: |
        playwright install chromium
        
    - name: ⚡ Run Smoke Tests (Chromium only)
      run: |
        python -m pytest -m smoke --browser=chromium -v --tb=line --maxfail=1
        
    - name: ✅ Quick Check Passed
      if: success()
      run: |
        echo "🎉 Quick smoke check passed! All critical functionality works."
        
    - name: ❌ Quick Check Failed
      if: failure()
      run: |
        echo "💥 Quick smoke check failed! Critical issues detected."
        exit 1
